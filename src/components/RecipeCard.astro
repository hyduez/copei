---
import { Icon } from 'astro-icon/components';
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import FormattedDate from './FormattedDate.astro';

interface Props {
  article: CollectionEntry<'articles'>;
}

const { article } = Astro.props;
const { title, description, category, pubDate, servings, image, tags, time } =
  article.data;

const getCategoryStyle = () => {
  switch (category) {
    case 'Healthy':
      return 'bg-green-100 text-green-700 border-green-200';
    case 'Junk':
      return 'bg-orange-100 text-orange-700 border-orange-200';
    default:
      return 'bg-purple-100 text-purple-700 border-purple-200';
  }
};

const getCategoryLabel = () => {
  switch (category) {
    case 'Healthy':
      return 'ü•ó Healthy';
    case 'Junk':
      return 'üçî Junk';
    default:
      return '‚öñÔ∏è Miscellaneus';
  }
};
---

<Fragment key={article.id}>
  <a href={`/articles/${article.id}`}>
  <article
  data-recipe-id={article.id}
  data-recipe-tags={tags?.join(',')}
  data-recipe-category={category}
  data-recipe-search={ (title + ' ' + description).toLowerCase() }
  class="recipe-card bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 overflow-hidden"
  >
    <div class="relative h-48 overflow-hidden">
        {image && <Image 
          src={image} 
          alt={title}
          class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
        />}
        <div class="absolute top-4 left-4">
          <span class={`px-3 py-1 rounded-full text-xs border ${getCategoryStyle()}`}>
            {getCategoryLabel()}
          </span>
        </div>
    </div>
    <div class="p-4">
      <h3 class="text-xl font-bold mb-2">{title}</h3>
      <p class="text-gray-600 text-sm mb-3">{description}</p>
      <div class="flex items-center text-xs text-gray-500 gap-3">
        <Icon name="mdi:clock" class="w-4 h-4" /> <span>{time}</span>
        <Icon name="mdi:users" class="w-4 h-4" /> <span>{servings} Servings</span>
      </div>
      <div class="flex flex-wrap gap-1 mt-3">
        {tags?.map(tag => (
          <span class="text-xs bg-gray-100 text-gray-700 px-2 py-0.5 rounded-full capitalize">
            {tag}
          </span>
        ))}
      </div>
    </div>
  </article>
  </a>
</Fragment>
